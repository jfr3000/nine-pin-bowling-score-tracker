<!DOCTYPE html>

<head>
  <link rel="manifest" href="manifest.json" />
  <link rel="stylesheet" href="styles.css">
  <script defer src="https://cdn.jsdelivr.net/npm/@alpinejs/sort@3.x.x/dist/cdn.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x/dist/cdn.min.js"></script>
  <script src="index.js"></script>
</head>

<body x-data="{settingsOpen: false}">
  <h1>Kegel-Tracker</h1>

  <div x-show="!settingsOpen">
    <div class="score-element">
      <template x-for="i in [...Array(10).keys()].reverse()">
        <button
          x-text="i"
          @click="$store.app.addResult(i)"
        />
      </template>
      <label class="toggle-container">
        <input type="checkbox" x-model="$store.app.isRightLaneSelected">
        <span class="slider"></span>
        <div class="labels">
          <span class="left-label" x-text="labels.toggleLeft"></span>
          <span class="right-label" x-text="labels.toggleRight"></span>
        </div>
    </label>
    <button @click="$store.app.deleteLastThrow()" x-text="labels.deleteLast" id="delete-button"></button>
    </div>
    <div x-show="$store.app.results.length > 0">
      <table id="results-table" x-data="$store.app.results" >
        <thead>
          <tr>
            <template x-for="columnHeader in $store.app.header">
              <th x-text="columnHeader.label" />
            </template>
          </tr>
        </thead>
        <tbody>
          <template x-for="line in $store.app.renderTableFromRawResults().reverse()">
            <tr>
              <template x-for="field in line">
                  <td x-text="field"></td>
              </template>
            </tr>
          </template>
        </tbody>
      </table>
      <div class="action-buttons">
        <button @click="$store.app.exportFile()" x-text="labels.export"></button>
        <button @click="$store.app.deleteResults()" x-text="labels.delete"></button>
        <button @click="settingsOpen = true" x-text="labels.configure"></button>
      </div>
    </div>
  </div>

  <div x-show="settingsOpen">
    <h2 x-text="labels.settings"></h2>
    <ul x-sort="$store.app.handleColumnSettingsDrag()" id="column-settings" x-sort-config="{filter: 'input', preventOnFilter: true,}">
      <template x-for="columnHeader in $store.app.initialHeaderForSettingsList">
        <li x-sort:item="columnHeader.id">
          <span x-sort:handle class="drag-handle">â‰¡</span>
          <input type="checkbox" x-model="columnHeader.display" @click="$store.app.getClickHandlerForColumnSetting(columnHeader.id)"/>
          <span x-text="columnHeader.label" />
        </li>
        </template>
    </ul>
      <div class="action-buttons">
        <button @click="settingsOpen = false" x-text="labels.close"></button>
        </div>
  </div>

  <script>
    if (typeof navigator.serviceWorker !== 'undefined') {
      navigator.serviceWorker.register('sw.js')
    }
  </script>
</body>

</html>