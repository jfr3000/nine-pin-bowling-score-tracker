<!DOCTYPE html>

<head>
  <link rel="manifest" href="manifest.json" />
  <link rel="stylesheet" href="styles.css">
  <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x/dist/cdn.min.js"></script>
  <script src="index.js"></script>
</head>

<body x-data="{isRightLaneSelected: false, results: getResultsFromStorage()}">
  <h1>Kegel-Tracker</h1>

  <div class="score-element">
    <template x-for="i in [...Array(10).keys()].reverse()">
      <button
        x-text="i"
        @click="addResult(isRightLaneSelected ? 'right' : 'left' , i, results)"
      />
    </template>
    <label class="toggle-container">
      <input type="checkbox" x-model="isRightLaneSelected">
      <span class="slider"></span>
      <div class="labels">
        <span class="left-label" x-text="labels.toggleLeft"></span>
        <span class="right-label" x-text="labels.toggleRight"></span>
      </div>
  </label>
</div>

  <div x-show="results.length > 0">
    <table id="results-table" x-data="results" >
      <thead>
        <tr>
          <template x-for="headerLabel in header">
            <th x-text="headerLabel" />
          </template>
        </tr>
      </thead>
      <tbody>
        <template x-for="line in renderTableFromRawResults(results).reverse()">
          <tr>
            <td x-text="line.throwNumber"></td>
            <td x-text="line.throwScore"></td>
            <td x-text="line.sum"></td>
            <td x-text="line.lane"></td>
            <td x-text="line.average"></td>
            <td x-text="line.sevenAverageDiff"></td>
          </tr>
        </template>
      </tbody>
    </table>
    <div id="action-buttons">
      <button @click="deleteLastThrow(results)" x-text="labels.deleteLast"></button>
      <button @click="exportAsTSV(results)" x-text="labels.export"></button>
      <button @click="deleteResults(results)" x-text="labels.delete"></button>
    </div>

  <script>
    if (typeof navigator.serviceWorker !== 'undefined') {
      navigator.serviceWorker.register('sw.js')
    }
  </script>
</body>

</html>